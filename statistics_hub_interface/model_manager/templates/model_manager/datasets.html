{% comment %} {% extends 'model_manager/base.html' %} {% endcomment %}

{% load static %}

{% block head %}
<style>
    /* Añade aquí tus estilos personalizados si es necesario */
</style>
<!-- Añadir jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>

<!-- Añadir DataTables CSS y JS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script>
{% endblock %}

{% block title %}Datasets{% endblock %}

{% block content %}
<div class="container">
    <h1>Mis Datasets</h1>
    <form method="post" id="dataset-form">
        {% csrf_token %}
        <label for="dataset-select">Elige un dataset:</label>
        <select id="dataset-select" name="dataset">
            {% for dataset in datasets %}
                <option value="{{ dataset }}" {% if dataset == selected_dataset %} selected {% endif %}>{{ dataset }}</option>
            {% empty %}
                <option value="">No hay datasets disponibles</option>
            {% endfor %}
        </select>
        <label for="separator">Separador CSV:</label>
        <input type="text" id="separator" name="separator" placeholder="Ej: ,">
        <input type="hidden" id="page" name="page" value="1">
        <input type="hidden" id="page_size" name="page_size" value="10">
        <button type="submit">Seleccionar</button>
    </form>

    {% if table_html %}
    <div class="data-table">
        {{ table_html|safe }}
    </div>
    <div class="pagination-buttons">
        <button id="prev-page">Anterior</button>
        <button id="next-page">Siguiente</button>
    </div>
{% endif %}
</div>

<script>
    $(document).ready(function() {
        // Inicializa DataTables
        var table = $('#myDataTable').DataTable({
            "paging": false,
            "info": false,
            "searching": false,
            "ordering": false,
            "lengthChange": false,
        });

        function updateAndSubmit(page, pageSize) {
            $('#page').val(page);
            $('#page_size').val(pageSize);
            $('#dataset-form').submit();
        }

        // Manejar clic en 'Siguiente'
        $('#next-page').on('click', function() {
            var currentPage = parseInt($('#page').val());
            updateAndSubmit(currentPage + 1, $('#page_size').val());
        });

        // Manejar clic en 'Anterior'
        $('#prev-page').on('click', function() {
            var currentPage = parseInt($('#page').val());
            updateAndSubmit(Math.max(1, currentPage - 1), $('#page_size').val());
        });
    });
</script>




{% endblock %}
